# Unicode

## 字符集、编码、Unicode

了解 Unicode 之前，先看一下计算机存储信息的方式。

无论是存储器中的晶体管通断，还是磁盘中的磁畴的极性，还是光盘中的坑槽，计算机总是使用两个不同的状态作为基本信息，即二进制。
而表示现实生活中更为复杂的实体，则需要通过多个这样的基本信息组合来完成。而在计算机中首先要被标识的就是字符。为了使二进制标识字符的方法在不同设计的计算机中通用，就需要统一字符编码方法，于是 ASCII 字符编码就出现了。

ASCII 码就是使用 7 个二进制位标识 128 个不同的字符，这个范围覆盖了英文字符，包括一些控制字符和标点符号，但是对于其他非字符的语言，如中文，这些就不够用了。

于是 ISO 和 Unicode 两个组织就发布了能唯一表示各个语言中的字符的标准。一个标准中能够表示的所有字符的集合成为字符集。而 ISO/Unicode 所定义的字符集叫做 Unicode。

在 Unicode中，每个字符占据一个码位，而 Unicode 字符集一共有 1 114 112 个这样的码位，从 0 到 10FFFF 的十六位进制数唯一地所有字符。

Unicode 的编码方式有 UTF-8,UTF-16,UTF-16。
以 UTF-8 为例，采用了 1~6 字节的变长编码方式编码 Unicode，英文字符用一个字节表示，与 ASCII 兼容，中文通常使用 3 字节表示。

在中文语言区，还有 GB2312，Big5 字符集和编码方式。

## C++11 的 Unicode 支持

C++11 引入了两种新的内置类型来存储不同编码长度的 Unicode 数据 char16_t 和 char32_t，前者用于存储 UTF-16 编码的 Unicode 数据，后者用于存储 UTF-32 编码的数据

C++11 使用 8 字节，16 字节，32 字节分别存储 UTF-8，UTF-16，UTF-32 编码的 Unicode 数据。

此外 C++11 还定义了一些常量字符串的前缀，在声明常量字符串时，这些前缀可以让编译器使字符串按照前缀类型产生数据。这种前缀类型一共有三种，分别是 u8，u，U 分别来表示 UTF-8，UTF-16，UTF-32 三种编码，

按照 C/C++ 规则
1. 如果来连续在代码中声明多个字符串字面量，则编译器就会自动将其连接起来。如 "a""b" 与 "ab" 的声明方式没有区别。
2. 如果连续声明的多个字符串字面量中的某一个是前缀的，则不带前缀的字符串字面量会被认为与带前缀的字符串字面量是同意给类型的。如 u"a""b" 和 "a"u"b" 效果 与 u"ab" 是等价的
3. 不要将各种前缀字符串字面量连续声明，因为标准定义除了 UTF-8 和宽字符字符串字面量同时声明会出冲突，其他字符串字面量的组合最终出现什么结果以及按照什么类型解释，是由编译器实现自行决定的。

对于 Unicode 编码字符的书写，C++11 规定了一些简明的方式，即在字符串使用 '\u' 加 4 个十六进制的 Unicode 码位来标识一个 Unicode 字符。如 '\u4F60' 

```
#include <iostream>
using namespace std;

int main()
{
    char utf8[] = u8"\u4F60\u597D\u554A";
    char16_t utf16[] = u"\u4F60\u597D\u554A";

    cout << sizeof(utf8) << endl;
    cout << sizeof(utf16) << endl;

    // cout << utf8[1] << endl;
    // cout << utf16[1] << endl;

    cout << utf8 << endl;
    cout << utf16 << endl;

    return 0;
}

/*
10
8
你好啊
0x7ffc8e546fe6
*/
```

## 关于 Unicode 库的支持