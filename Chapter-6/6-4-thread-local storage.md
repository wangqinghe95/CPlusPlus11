# 线程局部存储

线程局部存储指的是线程局部存储的变量，也就是拥有线程声明周期和线程可见性的变量。

通常情况下线程会拥有自己的栈指针，但是堆空间和静态数据区则是共享的，这样一来全局、静态变量在一个进程中的所有线程都是共享的。

那么就有一个场景如下，在多线程的环境中，我们如何表示一个线程的运行状态，比如该线程成功运行，该线程运行错误 1，2，3，4 种情况的错误码。我们不可能用一个全局变量来表示

所以就引入了线程局部存储变量，也就是为每个线程分配一个全局的 errno，即 TLS 的 errno。

g++/clang++/xlc++ 中，定义如下
`_thread int errCode`

C++11 中，对 TSL 做了一些统一的标准
`int thread_local errCode` 

一旦声明一个变量为 thread_local，其值将会在线程开始时被初始化，线程结束后该值不再生效。
C++11 没有对该关键字修饰的变量的内存地址做规定，所以该值分配在哪里，分配时间甚至是动态分配还是静态分配这些都依赖于平台和版本。

